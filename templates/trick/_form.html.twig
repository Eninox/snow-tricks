{{ form_start(form) }}
{#    {{ form_widget(form) }}#}

<ul id="media-fields-list"
    data-prototype="{{ form_widget(form.media.vars.prototype)|e }}"
    data-widget-tags="{{ '<li></li>'|e }}"
    data-widget-counter="{{ form.media|length }}">
    {% for pictureFile in form.media %}
        <li>
            {{ form_errors(pictureFile) }}
            {{ form_widget(pictureFile) }}
        </li>
    {% endfor %}
</ul>
<button type="button"
        class="add-another-collection"
        data-list-selector="#media-fields-list">Ajouter un média
</button>

<br><br><br>

Créateur de la trick : <br>
{{ app.user }}

<button class="btn">{{ button_label|default('Save') }}</button>
{{ form_end(form) }}

<script>
    jQuery(document).ready(function () {
        jQuery('.add-another-collection').click(function (e) {
            var list = $("#media-fields-list");
            var counter = list.data('widget-counter') | list.children().length;
            var newWidget = list.attr('data-prototype');
            newWidget = newWidget.replace(/__name__/g, counter);
            counter++;
            list.data('widget-counter', counter);

            var newElem = jQuery(list.attr('data-widget-tags')).html(newWidget);
            newElem.appendTo(list);
            newElem.append('<a href="#" class="remove-tag" style="color: darkred">remove</a>');
            $('.remove-tag').click(function(e) {
                e.preventDefault();

                $(this).parent().remove();

            });
        });
    });
</script>
